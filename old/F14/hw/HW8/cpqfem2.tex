
Let
\[
H^1_D(0,1)=\{w\in H^1(0,1):\,w(0)=w(1)=0\}
\]
and let the inner product $a\ip{\cdot,\cdot}:H^1_D(0,1)\times H^1_D(0,1)\to\R$ be defined by
\[
a\ip{v,w}=\int_0^1v'(x)w'(x)\,dx.
\]
Let N be a positive integer, let $\displaystyle{h={1 \over N+1}}$ and let $x_k=kh$ for $k=0,1,\ldots,N+1$. Let the continuous piecewise linear hat functions $\widehat{\phi}_j\in H^1_D(0,1)$ be such that
\[
\widehat{\phi}_j(x) = \left\{\begin{array}{ll}
\displaystyle{{(x-x_{j-1}) \over h}} & \displaystyle{\mbox{if }x\in[x_{j-1},x_j)},
\\[10pt]
\displaystyle{{(x_{j+1}-x) \over h}} & \displaystyle{\mbox{if }x\in[x_j,x_{j+1})},
\\[10pt]
0 & \mbox{otherwise},
\end{array}\right.
\]
for $j=1,\ldots,N$. Also, let the continuous piecewise quadratic functions $\phi_j\in H^1_D(0,1)$ be such that
\[
\phi_j(x)=\left\{\begin{array}{ll}
\displaystyle{{(x-x_{j-1})(2x-x_{j-1}-x_j) \over h^2}} & \displaystyle{\mbox{if }x\in[x_{j-1},x_j)},
\\[10pt]
\displaystyle{{(x_j+x_{j+1}-2x)(x_{j+1}-x) \over h^2}} & \displaystyle{\mbox{if }x\in[x_j,x_{j+1})},
\\[10pt]
0 & \mbox{otherwise},
\end{array}\right.
\]
for $j=1,\ldots,N$ and let the continuous piecewise quadratic bubble functions $\psi_j\in H^1_D(0,1)$ be such that
\[
\psi_j(x)=\left\{\begin{array}{ll}
\displaystyle{{4(x-x_{j-1})(x_j-x) \over h^2}} & \displaystyle{\mbox{if }x\in[x_{j-1},x_j)},
\\[10pt]
0 & \mbox{otherwise},
\end{array}\right.
\]
for $j=1,\ldots,N+1$.
\\
\begin{enumerate}
\item By hand, obtain formulas for
\\
\begin{enumerate}
\item $a\ip{\phi_j,\phi_k}$ for $j,k=1,\ldots,N$;
\\
\item $a\ip{\psi_j,\psi_k}$ for $j,k=1,\ldots,N+1$;
\\
\item $a\ip{\phi_j,\psi_k}$ for $j=1,\ldots,N$ and $k=1,\ldots,N+1$.
\\
\end{enumerate}
Your final answers should be in terms of $h$ and you must clearly state which values of $j$ and $k$ each formula you obtain is valid for. For example, if you were asked to obtain formulas for $a\left(\widehat{\phi}_j,\widehat{\phi}_k\right)$ for $j,k=1,\ldots,N$ then an acceptable way to present the answer would be:\newline
For $j,k=1,\ldots,N$,
\[
a\left(\widehat{\phi}_j,\widehat{\phi}_k\right)=\left\{\begin{array}{ll}\displaystyle{{2 \over h}} & \mbox{if }k=j, \\[.75em] \displaystyle{-{1 \over h}} & \mbox{if }\left|j-k\right|=1, \\[.75em] \displaystyle{0} & \mbox{otherwise}.\end{array}\right.
\]
\end{enumerate}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\ifthenelse{\boolean{showsols}}{\input cpqfem_sol}{}

